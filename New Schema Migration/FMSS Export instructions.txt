go to FMSS (need to request access from Scott Vantrees)
  - https://pfmdportal.nps.gov/index.cfm
click on AMRS (Asset Management Reporting System) in the Application list
  - or go directly to http://pfmdamrs.nps.gov/BOE/BI
Click on the Documents tab (top left)
Expand the Locations Folder
Double click the Location Specification Attribute Detail 
In the Crystal report configuration:
  - Select AKR in region values then click '>'
  - click '>>' in the parks list
  - click '>>' in the Asset Codes list
  - In the Location Spectemp Attribute(s) select the following
    - ASMISID  (only one record has data)
    - BLDGTYPE (keep, seem interesting, still need or get from FRP)
    - CLASSSTR
    - CLINO
    - FAMARESP
    - OPSEAS
    - PARKNAME
    - PARKNUMB
    - PRIMUSE
    (only 12 attributes per report; so do two reports)
    - NOLANE
    - NUMPLOT
    - PRKLNG
    - PRKWID
    - ROUTEID
    - RTENAME
    - TREADTYP
    - TRLGRADE
    - TRLUSE
    - TRLWIDTH
  - Click OK, and wait while the document is being processed.
  - Click the Export report buttton (top left)
    - select Microsoft Excel (97-2003) Data-only.  This creates a file
      called Location Specification Attributes Detail.xls in your downloads Folder
      Do not select CSV, this creates a 220MB file which includes a lot of header
      info on each line (and no column names)
  - import to SQL Server as FMSSExport_Location2 and 3
  - allow null on all, all nvarchar(50+) except FCI, 4000 char for long desc.  254 char for Description
  - Make sure leading zeros are not missing on Location, ParkNUM, and CLASSSTR columns

open the Location Detail Information report
  - Select AKR under region
  - Select Excel under Format
  - Select Yes for Long Description
  - OK, export to Excel
  - import to SQL Server as FMSSExport_Location1
  - allow null on all, all nvarchar(50+) except FCI, 4000 char for long desc.  254 char for Description


Expand the FRP folder
open FRP Related Data Information
  - Region = AKR
  - Operating (this is for status of record, not feature)
  - Yes to include long Description
  - Export to Excel (data only)
open in Excel, delete top 16 rows (everything above the column names)
Delete the extra columns; keep Location, DOI Code, Predominant Use, Asset Ownership, Occupant, Street Address, City, County, lat, long, Long Description
  - import to SQL Server as FMSSExport_FRP
  - allow null on all, all nvarchar(50+) 4000 char for long desc

Build final table:
SELECT l1.*, 
  nullif(l2.ASMISID,'') ASMISID, nullif(l2.BLDGTYPE,'') BLDGTYPE, nullif(l2.CLASSSTR,'') CLASSSTR, nullif(l2.CLINO,'') CLINO, nullif(l2.FAMARESP,'') FAMARESP, nullif(l2.OPSEAS,'') OPSEAS, nullif(l2.PARKNAME,'') PARKNAME, nullif(l2.PARKNUMB,'') PARKNUMB, nullif(l2.PRIMUSE,'') PRIMUSE,
  nullif(l3.NOLANE,'') NOLANE, nullif(l3.NUMPLOT,'') NUMPLOT, nullif(l3.PRKLNG,'') PRKLNG, nullif(l3.PRKWID,'') PRKWID, nullif(l3.ROUTEID,'') ROUTEID, nullif(l3.RTENAME,'') RTENAME, nullif(l3.TREADTYP,'') TREADTYP, nullif(l3.TRLGRADE,'') TRLGRADE, nullif(l3.TRLUSE,'') TRLUSE, nullif(l3.TRLWIDTH,'') TRLWIDTH,
  l4.DOI_Code, l4.Predominant_Use, l4.Asset_Ownership, l4.Street_Address, l4.City, l4.County, l4.Primary_Latitude__NAD_83_ as lat, l4.Primary_Longitude__NAD_83_ as lon, l4.FRP_Long_Description
into FMSSExport 
   FROM FMSSExport_Location1 as l1
left join FMSSExport_Location2 as l2 on l1.Location = l2.Location
left join FMSSExport_Location3 as l3 on l1.Location = l3.Location
left join FMSSExport_FRP as l4  on l1.Location = l4.Location;
alter table FMSSExport alter column Location NVARCHAR(50) not null
alter table FMSSExport add primary key (Location)
drop FMSSExport_Location1
drop FMSSExport_Location2
drop FMSSExport_Location3
drop FMSSExport_FRP


For Assets
    - Open the Asset Folder, and select the Asset Inventory List
    - Select AKR for Region, then click OK, wait
    - export to Excel (data only)
    - open in excel, delete junk at top, but not column names, sort by asset, and delete junk rows at bottom
      delete all columns but the Asset, Location and Description
    - save as CSV
    - open in atom and change CRLF to LF
    - import into SQLServer
      - database -> tasks -> import as flatfile...
      - into table FMSSExport_Assets, int -> nvarchar(10), Allow nulls, no PK 
      - remove null records, create index (no PK on Asset because it isn't unique ??)
          - select * from FMSSExport_Asset where asset in (select asset from FMSSExport_Asset group by asset having count(*) > 1) order by asset, location
        - delete FMSSExport_Asset where Asset is null
        - alter table FMSSExport_Asset alter column Asset NVARCHAR(10) not null
        - CREATE INDEX idx_FMSSExport_Asset_Asset ON FMSSExport_Asset (Asset ASC)

